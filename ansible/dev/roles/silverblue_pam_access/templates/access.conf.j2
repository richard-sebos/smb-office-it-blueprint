# PAM access control configuration for {{ hostname }}
# Generated by Ansible - silverblue_pam_access role
#
# Format: permission : users/groups : origins
#   + = allow
#   - = deny
#
# Groups must be in parentheses: (groupname)
# ALL matches everything

# ========================================
# Workstation-Specific Access Rules
# ========================================
# Only allow specific AD groups to log in to this workstation

{% if access_control.pam_access_rules is defined %}
{% for rule in access_control.pam_access_rules %}
{{ rule }}
{% endfor %}
{% else %}
# Default: Allow all authenticated users
+ : ALL : ALL
{% endif %}

# ========================================
# System Accounts (always allow)
# ========================================
# Allow root login from console and SSH (for emergency access)
+ : root : LOCAL
+ : root : 192.168.35.0/24
+ : root : 10.0.120.40

# ========================================
# Ansible Management
# ========================================
# Allow ansible-admin user from management network
+ : ansible-admin : 192.168.35.0/24
+ : ansible-admin : LOCAL

# ========================================
# Default Deny
# ========================================
# Explicitly deny everything else
# - : ALL : ALL
